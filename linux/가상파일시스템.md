# 가상파일시스템(VFS)

## 가상 파일 시스템을 배워야하는 이유
1. 파일시스템 동작원리를 파악하기위해서
- 리눅스는 모든 객체를 파일로 관리함
- 파일시스템에 진입하기 위한 관문이 가상파일 시스템임

2. 리눅스 시스템 프로그래밍을 잘 하기 위해서
- 50% 이상의 리눅스 표준 입출력 함수는 파일을 처리함

3. 커널 디버깅을 잘 하기 위해서
- 많은 리눅스 커널의 서브 시트메에서 가상 파일 시스템에서 제공하는 자료구조를 활용하기위해서

가상파일시스템이란
- 커널에서 다양한 파일 시스템이 공존하며 동적으로 실행할 수 있는 가상 소프트웨어 계층
- 가상 파일 시스템은 추상화된 파일 시스템임

가상파일시스템 주요 특징
- 가상파일시스템을 통해서 파일시스템에 접근
- 여러 파일 시스템에서 공통으로 파일과 디렉터리를 관리할수있는 자료구조로 구성
- 대부분의 디바이스 드라이버는 가상파일시스템과 연동되서 동작
- 파일 시스템을 관리핳수있는 공통자료구조로 시스템의 속성 관리


<유저공간>
유저 애플리케이션
open write read 함수호출
----------------------------------------
<커널공간>
소프트웨어 인터럽트 시스템 콜
sys_open, sys_write, sys_read, sys_clone, ...
vfs_open, vfs_write, ... 가상 인터페이스 호출
가상파일시스템 api 함수
파일시스템 접근

유저 프로그램
     │
   (syscall)
     │
 ┌───▼───┐
 │  VFS  │  ← 가상 파일시스템 계층 (공통 인터페이스)
 └───┬───┘
     │
 ┌──────────────┬──────────────┬───────────────────┐
 │ ext4 (디스크) │ tmpfs (RAM)  │ procfs (커널정보)  │
 └──────────────┴──────────────┴───────────────────┘




## 가상 파일 시스템의 전체계층구조 설명

가상파일시스템 역할
- 시스템콜 호출시 파일시스템과 연결해주는 소프트웨어 계층

VFS 역할
- 추상화 인터페이스를 지원
- 새로운 파일시스템 적용해도 유저 애플리케이션은 호환성 유지
-가상 파일 시스템이 각각의 파일 시스템 별 롤 구현된 함수를 호출
- 리눅스 파일 시스템이 하나인것처럼 느낌

## 가상 파일시스템의 공통 모델
- 파일 시스템 별 공통으로 저장하고 관리하는 파일 시스템 별 파일 속성과 디렉토리, 파일 시스템별 메타데이터를 관리하는 구조체
객체 종류
- 슈퍼블록
- 아이노드
- 덴트리
- 파일 

