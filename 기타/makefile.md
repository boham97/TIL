### Makefile

```bash
target: prerequisites
	command

```

생성 파일: 필요 목록 <- 필요 목록으로 순서 정할수 있다 안정한면 병렬처리되어 순서 섞일수있음

​	타겟 생성 명령어

변수 `$`와 `()` 또는 `{}`로 참조

```bash
CC = gcc
CFLAGS = -Wall -g
SRC = main.c utils.c
OBJ = $(SRC:.c=.o)				#.c를 .o로 변경

all:
    $(CC) $(CFLAGS) $(SRC) -o program
```

자동 변수

```bash
$@: 현재 타겟 이름
$^: 모든 prerequisites
$<: 첫 번째 prerequisite
$?: prerequisites 중 변경된 파일
$MAKE: make 내부에서 재귀적으로 make 명령 호출

program: main.o utils.o
    $(CC) -o $@ $^

main.o: main.c
    $(CC) $(CFLAGS) -c $< -o $@
```



### 옵션

- **`-f`**: 사용할 `Makefile`의 이름을 지정합니다. 기본적으로 `make`는 현재 디렉터리의 `Makefile`을 사용하지만, 이 옵션을 통해 다른 파일을 사용할 수 있습니다.

  ```bash
  make -f custom_makefile.mk
  ```

- **`-j [N]`**: **병렬 빌드**를 활성화합니다. `N`은 동시에 실행할 작업 수를 지정합니다. `N`을 생략하면 가능한 모든 작업을 병렬로 실행하려고 시도합니다.

  ```bash
  make -j 4  # 4개의 작업을 병렬로 실행
  ```

- **`-C`**: 지정한 디렉터리로 **변경**하여 해당 디렉터리에서 `Makefile`을 실행합니다.

- **`-B`**: **강제로** 모든 타겟을 **다시 빌드**합니다. 이 옵션을 사용하면, `Makefile`에 정의된 타겟이 최신 상태일지라도 강제로 모든 타겟을 재빌드합니다.

- **`-n`** 또는 **`--dry-run`**: 실제로 명령을 실행하지 않고, 실행할 명령을 **출력만** 합니다. 빌드 과정을 확인하는 데 유용합니다.

- **`-s`**: 명령 실행을 출력하지 않도록 합니다. 명령어 실행 결과는 출력되지 않지만, 작업은 그대로 진행됩니다.

- **`-k`**: 오류가 발생해도 가능한 한 **계속 실행**합니다. 즉, 하나의 타겟에서 오류가 발생해도 다른 타겟은 실행됩니다.

- **`-t`**: 실제로 빌드를 실행하지 않고, **타겟이 최신 상태인지 확인**하고, 최신 상태인 것으로 처리하여 `Makefile`에 정의된 타겟을 업데이트하지 않습니다

- **`-v`** 또는 **`--version`**: `make` 버전 정보를 출력합니다.

- **`-p`** 또는 **`--print-data-base`**: `Makefile` 내의 모든 변수, 규칙 등을 출력합니다. 이를 통해 `make`의 상태를 확인할 수 있습니다.

### **2. 타겟 관련 옵션**

- **`-d`**: **디버그 출력**을 활성화합니다. `make`의 내부 작업을 자세히 출력하여 문제를 추적할 수 있게 해줍니다.

- **`-I <dir>`**: `Makefile` 내에서 `include` 지시어로 포함할 디렉터리를 추가합니다. 기본적으로는 현재 디렉터리만 검색합니다.

- **`-w`** 또는 **`--print-directory`**: 각 디렉터리에서 어떤 작업을 하는지 **출력**합니다.

- **`-l [load]`**: 시스템의 **부하(load)** 를 기준으로 병렬 빌드를 제한합니다. 이 값을 넘어서면 병렬 작업이 지연됩니다.

  ```
  make -l 2.0  # 시스템 부하가 2.0을 넘지 않도록 제한
  ```